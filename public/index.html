<!DOCTYPE html>
<html>
<head>
    <title>socket</title> 
    <script
    src="https://code.jquery.com/jquery-3.1.1.slim.min.js"
    integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc="
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">

</head>
<body>
    <main class="mdl-layout__content">
        <div class="page-content mdl-grid">
            <!-- Your content goes here -->
            <div class="topbar mdl-grid">
                <!-- Deletable Chip -->
                <span class="mdl-chip mdl-chip--deletable">
                    <span class="mdl-chip__text">Deletable Chip</span>
                    <button type="button" class="mdl-chip__action"><i class="material-icons">cancel</i></button>
                </span>
                <span class="mdl-chip mdl-chip--deletable">
                    <span class="mdl-chip__text">Deletable Chip2</span>
                    <button type="button" class="mdl-chip__action"><i class="material-icons">cancel</i></button>
                </span> 
                <span class="mdl-chip mdl-chip--deletable">
                    <span class="mdl-chip__text">Deletable Chip3</span>
                    <button type="button" class="mdl-chip__action"><i class="material-icons">cancel</i></button>
                </span> 
                <!-- Simple Textfield -->
                <form id="keywordform" action="#">
                <div class="mdl-textfield mdl-js-textfield">
                    <input class="mdl-textfield__input" type="text" id="keyword">
                    <label class="mdl-textfield__label" for="keyword">Text...</label>
                </div>
                </form>
            </div>

            <div "canvas mdl-grid">

            </div>
        </div>
    </main>
    </div>
    <ul id="list"></ul>

    <script src="./socket.io.js"></script>
    
    <script>
        var socket = io.connect("http://localhost:3000");
        var divs = [];
        var bitRowMap = new Array(20).fill(0);
        var divid = 0;
        var rowNum; 
        socket.on('tweet', function(data){
            // console.log(data);
            if (Math.random() > 0.97) {

                var div = document.createElement("div");
                div.setAttribute("class", "tweet");
                div.setAttribute("id", divid = divid++ % 30);
      
                div.appendChild(document.createTextNode(data.message));
                
                do {
                    rowNum = (Math.round(Math.random() * 20));
                } while (bitRowMap[rowNum] == 1);

                div.style.top = Math.round(rowNum * 5)+ "%";
                bitRowMap[rowNum] = 1;
                divs.push((divid, rowNum));
                console.log(bitRowMap);

                div.style.left = (Math.round(Math.random() * 100)) + "%";
                $("body").append(div);
                
                while (divs.length > 30) {
                    var divRemoved = divs.shift();
                    $("#" + divRemoved[0]).remove();
                    bitRowMap[divRemoved[1]] = 0;
                }
            }
        });
    </script>

    <!--<div class="tweet">
        <h3>test</h3>
    </div>
    <ul id="list"></ul>-->

    <script defer src="https://code.jquery.com/jquery-3.1.1.min.js"  crossorigin="anonymous"></script>
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script> 
    <script defer src="socket.io.js"></script>
    <script defer src="flyingtweets.js"></script> 
</body>
</html>


